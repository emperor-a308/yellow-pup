<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Monad Airdrop Claim</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
  <h2>Monad Airdrop</h2>
  <button id="connect">Connect Wallet</button>
  <p id="wallet">Not connected</p>
  <p id="claimable">Claimable: 0 MON</p>
  <button id="claim" disabled>Claim</button>

  <script>
    const contractAddress = "0x8152Be2479bd49C749b4ED850e83a1Dfe2356c89";
    const contractABI = [
      "function claimable(address) view returns (uint256)",
      "function claimed(address) view returns (bool)",
      "function claim()"
    ];

    let provider, signer, contract, userAddress;

    async function connectWallet() {
      if (!window.ethereum) return alert("MetaMask not found");
      await ethereum.request({ method: 'eth_requestAccounts' });
      provider = new ethers.providers.Web3Provider(window.ethereum);
      signer = provider.getSigner();
      userAddress = await signer.getAddress();
      document.getElementById('wallet').innerText = "Connected: " + userAddress;

      contract = new ethers.Contract(contractAddress, contractABI, signer);
      await updateClaimable();
    }

    async function updateClaimable() {
      const amount = await contract.claimable(userAddress);
      const claimed = await contract.claimed(userAddress);
      const mon = ethers.utils.formatEther(amount);
      document.getElementById('claimable').innerText = `Claimable: ${mon} MON`;

      const claimBtn = document.getElementById('claim');
      if (amount.gt(0) && !claimed) {
        claimBtn.disabled = false;
      } else {
        claimBtn.disabled = true;
      }
    }

    async function claim() {
      try {
        const tx = await contract.claim();
        await tx.wait();
        alert("Claimed!");
        updateClaimable();
      } catch (e) {
        alert("Error: " + e.message);
      }
    }

    document.getElementById('connect').onclick = connectWallet;
    document.getElementById('claim').onclick = claim;
  </script>
</body>
</html>
